PROJECT( telldus-core )

CMAKE_MINIMUM_REQUIRED( VERSION 2.6.0 )

CMAKE_POLICY(SET CMP0003 NEW)

SET(PACKAGE_MAJOR_VERSION 2)
SET(PACKAGE_MINOR_VERSION 1)
SET(PACKAGE_PATCH_VERSION 0)
SET(PACKAGE_VERSION "${PACKAGE_MAJOR_VERSION}.${PACKAGE_MINOR_VERSION}.${PACKAGE_PATCH_VERSION}")
SET(PACKAGE_SUBVERSION)
SET(PACKAGE_SOVERSION 2)

IF (PACKAGE_SUBVERSION)
  SET(DISPLAYED_VERSION "${PACKAGE_VERSION}_${PACKAGE_SUBVERSION}")
ELSE (PACKAGE_SUBVERSION)
  SET(DISPLAYED_VERSION ${PACKAGE_VERSION})
ENDIF(PACKAGE_SUBVERSION)

SET(BUILD_LIBTELLDUS-CORE	TRUE	CACHE BOOL "Build libtelldus-core")

SET(USE_QT_SETTINGS_BACKEND FALSE CACHE BOOL "Use QT as settings backend instead of the native one")
IF (WIN32)
	SET(SIGN_FILES FALSE CACHE BOOL "Sign the generated files. This requires a certificate to be installed on the computer!")
ENDIF (WIN32)

IF (WIN32)
	SET(TDTOOL_DEFAULT FALSE)
	SET(TDADMIN_DEFAULT FALSE)
ELSEIF(APPLE)
	SET(TDTOOL_DEFAULT TRUE)
	SET(TDADMIN_DEFAULT FALSE)
ELSE (WIN32)
	SET(TDTOOL_DEFAULT TRUE)
	SET(TDADMIN_DEFAULT TRUE)
ENDIF (WIN32)

IF (CMAKE_SYSTEM_NAME MATCHES "FreeBSD")
	INCLUDE_DIRECTORIES(/usr/local/include)
	LINK_DIRECTORIES(/usr/local/lib)
ENDIF (CMAKE_SYSTEM_NAME MATCHES "FreeBSD")

SET(BUILD_TDTOOL	${TDTOOL_DEFAULT}	CACHE BOOL "Build tdtool")
SET(BUILD_TDADMIN	${TDADMIN_DEFAULT}	CACHE BOOL "Build tdadmin")

SET(GENERATE_MAN	FALSE	CACHE	BOOL "Enable generation of man-files")

# Lets figure if we need to build against Qt or not
IF(USE_QT_SETTINGS_BACKEND)
	SET(BUILD_WITH_QT TRUE)
ENDIF(USE_QT_SETTINGS_BACKEND)

ADD_SUBDIRECTORY(common)
ADD_SUBDIRECTORY(service)
ADD_SUBDIRECTORY(client)

IF(BUILD_TDTOOL)
	ADD_SUBDIRECTORY(tdtool)
ENDIF(BUILD_TDTOOL)
IF(BUILD_TDADMIN)
	ADD_SUBDIRECTORY(tdadmin)
ENDIF(BUILD_TDADMIN)
